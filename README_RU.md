# Документация API мониторинга GS4u

## Ссылка: https://api.gs4u.net/
Команды надо отправлять в переменной "cmd", пример: https://api.gs4u.net/?cmd=getVersion

### Доступны следующие команды:
* "**getVersion**" - выдаёт актуальную версию API. Можно использовать для проверки доступности API.
  * Параметры не нужны.
  * Запрос GET будет выглядеть так ```https://api.gs4u.net/?cmd=getVersion```
* "**getCoolDown**" - даёт время в секундах, как часто можно использовать присланную в параметре команду.
  * Параметры:
    * "**data**" - JSON объект следующей структуры: {"cmd":"updateServer"}. В данном примере запрашивается, 
      как часто можно использовать команду "updateServer".
    * Запрос GET будет выглядеть так ```https://api.gs4u.net/?cmd=getCoolDown&data={"cmd":"updateServer"}```
* "**updateServer**" - обновить информацию о сервере в мониторинге. Нужно отправлять данные о сервере подписанные токеном. 
  * Параметры:
    * В переменной "**data**" отправляются данные сервера в формате JSON. Ниже есть пример такого объекта.
    * В переменной "**s**" отправляется подпись/хеш данных с токеном. Ниже читайте о том как создать подпись.
    * ОПЦИОНАЛЬНО "**hash**" для использования другого метода хеширования.
  * Запрос GET мог бы выглядеть так ```https://api.gs4u.net/?cmd=updateServer&data={"n":"My Server"...}&s=w3e5g...56```
  * НО НЕ ИСПОЛЬЗУЙТЕ запрос GET, так как данные сервера в него не поместятся! Используйте POST!
* "**getServerInfo**" - запрос на получение всех данных сервера
  * Параметры:
    * В переменной "**data**" - JSON объект следующей структуры: ```{"server_id":"123456","user_id":"123456","rnd":"Ad84Kbd8"}```.
      * **server_id** - Server ID в мониторинге GS4u
      * **user_id** - ваш User ID со страницы получения личного токена
      * **rnd** - случайно сгенерированные данные
    * В переменной "**s**" отправляется подпись/хеш данных с токеном. Ниже читайте о том как создать подпись.
    * ОПЦИОНАЛЬНО "**hash**" для использования другого метода хеширования.
  * Запрос GET мог бы выглядеть так ```https://api.gs4u.net/?cmd=getServerInfo&data={"server_id":"123456","user_id":"123456"}}&s=w3e5g...56```

## Получить информацию о сервере - getServerInfo
Для этого вам нужен персональный токен и ваш User ID

### Создание хеша (подписи / сигнатуры)
Для создания подписи необходимо объединить в одну строку следующие данные:
**server_id** + **user_id** + **rnd** + **token**
и создать хеш этой строки: ```md5(**server_id** + **user_id** + **rnd** + токен)```
#### Например
если ```server_id = '123'```, ```user_id = '543'```, ```rnd = 'ABC'```, а ```token = '321'```, то хеш равен ```s = md5('123543ABC321')```

## Обновление данных сервера в мониторинге - updateServer
Для этого вам нужен Server ID и токен для сервера из мониторинга

### Создание хеша (подписи / сигнатуры)
В мониторинге для своего сервера вы можете сгенерировать токен. 
Он нужен, для того чтобы создавать подпись.
Подпись строится следующим образом: ```md5(**data** + токен)```
то есть создаётся хеш MD5 из строки, которая включает в себя данные и токен.
#### Например
если ```data = 'ABC'```, а ```token = '123'```, то хеш равен ```s = md5('ABC123')```

### ФОРМАТ данных сервера JSON:
```json
{
 "n":"Название сервера",
 "m":"Карта",
 "pc":"Количество играющих сейчас игроков",
 "pm":"Количество слотов для игроков",
 "e":{
  "password":"1 если для входа на сервер нужен пароль, 0 если нет",
  "game":"кодовое название игры, для CS:GO это 'csgo'",
  ... можно другие дополнительные данные о сервере...
 },
 "tabs":
 [
  {
   "name":"Name for Tab 1",
   "data":[
    {
     "name":"Name for Group 1",
     "data":[
      {
       "name":"Name for Item 1",
       "description":"Description for Item 1"
      },
      {
       "name":"Name for Item 2",
       "description":"Description for Item 2"
      },
     ]
    },
    {
     "name":"Name for Group 2",
     "data":[
      {
       "name":"Name for Item 3",
       "description":"Description for Item 3"
      }
     ]
    }
   ]
  },
  {
   "name":"Name for Tab 2",
   "data":[
    {
     "name":"Name for Group 1",
     "data":[
      {
       "name":"Name for Item 1",
       "description":"Description for Item 1"
      }
     ]
    }
   ]
  }
 ],
 "p":
 [
  {
   "name":"Ник игрока",
   "kills":"количество фрагов",
   "deaths":"количество смертей",
   "time":"как долго игрок уже на сервере",
   "team":"номер команды",
   "lvl": "уровень игрока",
   ...можно другие данные ещё...
  },
  {...другой игрок...}
 ]
}
```

### Коды игр для "game"
[Коды всех игр в можно найти тут](README_GAMES.md)

## Альтернатива MD5
Если MD5 вам по какой то причине не подходит вы можете передать так же перменную **hash** и указать способ хеширования.
На данный момент поддерживаются следующие методы хеширования:
* md5
* sha1

# ОШИБКИ:
0 - нет ошибок

-1000 - Токен для вашего сервера не создан.

-2001 - Токен создан, но по какой то причине пуст. Обратитесь в службу поддержки.

-2002 - Токен не оплачен.

-2003 - Проверка дигитальной подписи не пройдена, вы используете неверный токен?

-3000 - Вы шлёте слишком много запросов.

-3001 - Вы отправили неизвестную команду в "cmd".

-7002 - вы прислали данные в JSON формате с неверным синтаксисом.

-1011 - в данных не был найден ServerID

-1001 - не прислано либо "data" либо "s"
